<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Slugs & Dinos</title>
    <link rel="stylesheet" href="./assets/reset.css" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Bungee+Shade" rel="stylesheet">
    <link rel="stylesheet" href="./assets/index.css" type="text/css">
    <link rel="stylesheet" href="./external/jquery-ui.min.css">
    <link rel="icon" type="image/gif" href="assets/images/favicon.ico">
    <script src="./external/jquery/jquery.js"></script>
    <script src="./external/jquery-ui.min.js"></script>
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script src="./assets/javascripts/bundle.js"></script>


    <script>
      function dragstart_handler(ev) {
        $(ev.target).attr("id", "selected");
        console.log("dragStart");
        // Add the target element's id to the data transfer object
        const data = event.dataTransfer;
        // data.setDataAt("image/png", stream, 0);
        // data.setDataAt("application/x-moz-file", file, 0);
        // data.setData("text/uri-list", ev.target.src);
        // data.setData("text/uri-plain", ev.target.src);
        ev.dataTransfer.setData("text/plain", ev.target.id);
        var img = new Image();
        img.src = 'assets/images/four-expand-arrows.png';
        ev.dataTransfer.setDragImage(img, 10, 10);
        debugger
        ev.dataTransfer.dropEffect = "move";

      }

      function dragover_handler(ev) {
       ev.preventDefault();
       // Set the dropEffect to move
       ev.dataTransfer.dropEffect = "move"
      }

    function drop_handler(ev) {
       ev.preventDefault();
       // Get the id of the target and add the moved element to the target's DOM
       var data = ev.dataTransfer.getData("text");
       if (!data){
         debugger
         dragstart_handler(ev);
       }

       const toElement = $(ev.target.parentElement);
       const image = "." + ev.target.src.slice(51);
       debugger
       const fromElement = $(document.getElementById(data).parentElement)
       debugger

       toElement.html("").append(document.getElementById(data))
       fromElement.append(`<img src=${image} draggable="true" ondrop="drop_handler(event);" ondragover="dragover_handler(event);" ondragstart="dragstart_handler(event);" height="54px">`)
       $(document.getElementById(data)).removeAttr('id')
      //  ev.target.parentElement.appendChild(document.getElementById(data));
       debugger

    }


// "." + image.slice(51)

    </script>















    <script>
// function allowDrop(ev) {
//     ev.preventDefault();
// }
//
// function drag(ev) {
//     $(ev.target).attr("id", "selected");
//     ev.dataTransfer.setData("text/plain", ev.target.id);
//     ev.target.style.opacity = "0.4";
//     // debugger
// }
//
// function drop(ev) {
//     ev.preventDefault();
//     debugger
//
//     // const image = document.createElement('img');
//     const data = ev.dataTransfer.fromElement(document.getElementById('selected'));
//     debugger
//     $(ev.currentTarget).html(document.getElementById(data))
//
//     // image.innerHTML = data
//     // const $dropTarget = ev.currentTarget;
//     debugger
//
//     // $(ev.currentTarget).html(document.getElementById(data));
//

    // ev.currentTarget.removeClass("icon").append(data);
// }
</script>
  </head>
  <body>
    <div class="gamescreen">

      <div class="header">
        <img id="dinoImg1" src="./assets/images/rex.svg">
        <h1 id="title">Slugs & Dinos</h1>
        <img id="dinoImg2" src="./assets/images/rex.svg">
      </div>

      <div class="content">
        <div class="control-panel-column">
          <button id="start" type="button" name="button">START</button>
          <div class="scoreDiv">
            <img id="eggImg" src="./assets/images/egg.svg">
            <h2 id="label">Score</h2>
          </div>

          <div id="progressBar"></div>

        </div>
        <figure class="gameboard"></figure>
      </div>

    </div>
  </body>
</html>
